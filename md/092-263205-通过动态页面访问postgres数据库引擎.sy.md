---
show: step
version: 1.0
enable_checker: true
---

# åŠ¨æ€ç½‘é¡µ

### å›å¿†

- ä¸Šæ¬¡æˆ‘ä»¬ç¼–è¾‘ Postgres.java æˆåŠŸè®¿é—®äº† pqæ•°æ®åº“
	- é¦–å…ˆè¦å¯¼å…¥ç±»åº“
	- ç„¶åè¦å¼€å¯æ•°æ®åº“
	- å¹¶äº†è§£æ•°æ®åº“çš„ç”¨æˆ·åå¯†ç 
	- è¦ç”¨æ­£ç¡®çš„è¿æ¥ã€åº“ã€è¡¨ã€å­—æ®µ
	- è¿˜è¦ä½¿ç”¨æ­£ç¡®çš„sqlè¯­å¥
- å‡†å¤‡å·¥ä½œå®Œæ¯•
	- all parts accounted for.
	- ä¸‹ä¸€æ­¥å°±æ˜¯è¦æ•´åˆservlet
	- åœ¨æµè§ˆå™¨é‡Œé¢æŠŠé¡µé¢æ˜¾ç¤ºå‡ºæ¥
	- å®¢æˆ·é€šçŸ¥å ‚å€Œ
	- è®©å ‚å€Œé€šçŸ¥å¤§å¨
	- åå¨åšå¥½å†…å®¹
	- å ‚å€Œä¸Šèœ
	- å®¢æˆ·åƒä¸Šé¥­
- è¿™åˆæ€ä¹ˆåšå‘¢ï¼ŸğŸ¤”

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220509-1652111566510)

### æ¢å¤app

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658017758878)

- å¯ä»¥æŠŠä¸Šä¸Šæ¬¡å¤‡ä»½çš„åº”ç”¨æ¢å¤å‡ºæ¥

### èµ„æº

- ä¸ä½†æ•´åˆä»£ç 
- ä¹Ÿè¦æ•´åˆéœ€è¦ç”¨åˆ°çš„åŒ…

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220425-1650888498712)

- è¿™ä¸ªæ˜¯ä¸€ä¸ªåŸå§‹çš„servlet
- ä»–æ¥æ”¶è¯·æ±‚request
- ä½œå‡ºå“åº”
- åœ¨ç½‘é¡µä¸­æ˜¾ç¤º`ä½ å¥½,tomcat`


### å¤åˆ¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220425-1650891511158)

- å…ˆæŠŠOeasyServlet.javaå¦å­˜ä¸ºSelectServlet.java
- å¹¶ä»¥SelectServlet.javaä¸ºåŸºç¡€æ•´åˆPostgres.java

### æ•´åˆ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220426-1650978230308)

- æ–°çš„servletè¿˜æ˜¯
	- æ¥æ”¶è¯·æ±‚request
	- ä½œå‡ºå“åº”response
- åªä¸è¿‡è¿™ä¸ªå“åº”çš„å†…å®¹æ¥è‡ªæ•°æ®åº“æŸ¥è¯¢ç»“æœ
	- æ•°æ®åº“æŸ¥è¯¢æ¥è‡ªäºPostgresJdbc.java


### ç¼–è¯‘

```
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.io.IOException;
import java.io.PrintWriter;
import jakarta.servlet.ServletException;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
public class SelectServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;
    @Override
    public void doGet(HttpServletRequest request,
                      HttpServletResponse response)
        throws IOException, ServletException
    {
        response.setContentType("text/html");
        response.setCharacterEncoding("UTF-8");
        PrintWriter out = response.getWriter();
        out.println("<!DOCTYPE html><html><body>");
        Connection c = null;
        Statement stmt = null;
        try {
            Class.forName("org.postgresql.Driver");
            c = DriverManager.getConnection(
                    "jdbc:postgresql://localhost:5432/oeasy", "postgres",
                    "oeasy@pg");
            c.setAutoCommit(false);

            out.println("connection is ok<br/>");
            stmt = c.createStatement();

            ResultSet rs = stmt.executeQuery("select * from urls where topic like 's%'");
            while(rs.next()){
                String topic = rs.getString("topic");
                String url = rs.getString("url");
                out.print(topic+":"+url+"<br/>");
            }
            rs.close();
            stmt.close();
            c.close();

        } catch (Exception e) {
            e.printStackTrace();
            System.err.println(e.getClass().getName() + ": " + e.getMessage());
        }
        out.println("select query is ok!<br/>");
        out.println("</body></html>");
    }
}

```

- è¾“å‡ºçš„responseæ¥è‡ªäºæ•°æ®åº“
	- æ•°æ®åº“æ˜¯é€šè¿‡é©±åŠ¨
	- æ¥è¯»å†™æœ¬åœ°localhostçš„5432ç«¯å£
	- å¾—åˆ°ç›¸åº”çš„æ•°æ®çš„
- ç¼–è¯‘æ²¡æœ‰é—®é¢˜
- é‡å¯æœåŠ¡å™¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658065472376)

- åœ¨æµè§ˆå™¨ä¸­è®¿é—®èµ„æº

### è®¿é—®


![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211121-1637502042563)

- çœ‹èµ·æ¥æ˜¯ä»urlåˆ°classæ²¡æœ‰ç›¸åº”çš„è·¯ç”±
- é‚£ä¹ˆæˆ‘ä»¬è¦é…ç½®web.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
                      http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"
  version="3.1">

    <display-name>Hello, World Application</display-name>
    <description>
        This is a simple web application with a source code organization
        based on the recommendations of the Application Developer's Guide.
    </description>

    <servlet>
        <servlet-name>HelloServlet</servlet-name>
        <servlet-class>HelloWorldExample</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>HelloServlet</servlet-name>
        <url-pattern>/hello</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>OeasyServlet</servlet-name>
        <servlet-class>OeasyServlet</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>OeasyServlet</servlet-name>
        <url-pattern>/oeasy</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>SelectServlet</servlet-name>
        <servlet-class>SelectServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>SelectServlet</servlet-name>
        <url-pattern>/select</url-pattern>
    </servlet-mapping>
</web-app>
```


### ç»†èŠ‚
- æˆ‘ä»¬é…ç½®web.xml
	- æ³¨æ„æœ€åä¸€ç»„æ˜ å°„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220425-1650892188963)

- ç„¶åé‡å¯æœåŠ¡å™¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211121-1637502525096)

- é¡ºåˆ©åœ°è¯»å‡ºäº†postgresé‡Œé¢çš„oeasyåº“ä¸­çš„urlsè¡¨ä¸­çš„ä¿¡æ¯ï¼
- å¦‚æœæœ‰é—®é¢˜å¯ä»¥å»æ—¥å¿—é‡Œé¢çœ‹çœ‹
- æœ‰å¯èƒ½æ˜¯å› ä¸ºpostgresæœåŠ¡æ²¡æœ‰å¼€
- å¾ˆå¼€å¿ƒï¼
- æ•´åˆæˆåŠŸ

### å›é¡¾

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220505-1651720737181)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220505-1651727871909)

- å¦‚æœwebæœåŠ¡å™¨åŒæ—¶æ˜¯æ•°æ®åº“æœåŠ¡å™¨
- åˆåšå ‚å€Œåˆåšå¤§å¨

### æ‘Šä½

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220510-1652140174629)

- åˆæ”¶é’±ã€åˆåšé¥­
- ä¿¡æ¯ä¼ é€’æˆæœ¬ä½
- ä¸ªä½“ä»»åŠ¡é‡å¤§

### åˆ†å·¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220509-1652111295694)

- ä¸“é—¨æœ‰ä¸ªæ•°æ®æœåŠ¡å™¨
	- åˆ†å·¥
	- èŒä¸šä¼˜åŒ–
- åº”ç”¨æœåŠ¡å™¨å‘æ•°æ®åº“æœåŠ¡å™¨å‘è¯·æ±‚
- æ•°æ®åº“æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚å¹¶è¿›è¡Œå“åº”

### ä¸‰ç§è¿æ¥æ•°æ®åº“çš„æ–¹å¼

- ç”¨psqlå®¢æˆ·ç«¯ç›´æ¥è¿æ¥
	- ç›´æ¥ç”¨æ•°æ®åº“ç®¡ç†å‘˜ç™»å½•æ•°æ®æ‰€åœ¨æœåŠ¡å™¨
	- ç”¨psqlç¨‹åºç›´æ¥å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’
- ç”¨javaç¨‹åºé€šè¿‡postgresçš„driverè¿æ¥
	- åŠ è½½postgresçš„driverçš„ç±»åº“
	- ä½¿ç”¨javaè°ƒç”¨é©±åŠ¨ä¸­çš„apiè¿›è¡Œè¿æ¥å¹¶æŸ¥è¯¢
	- è¿è¡Œååœ¨ç»ˆç«¯æ˜¾ç¤ºæŸ¥è¯¢ç»“æœ
- ç”¨tomcatçš„servleté€šè¿‡postgresçš„driverè¿æ¥
	- åœ¨tomcatçš„servletçš„åŸºç¡€ä¸Š
	- åŠ è½½postgresçš„driverçš„ç±»åº“
	- ä½¿ç”¨javaè°ƒç”¨é©±åŠ¨ä¸­çš„apiè¿›è¡Œè¿æ¥å¹¶æŸ¥è¯¢
	- ç¼–è¯‘æˆclassæ–‡ä»¶åæ˜ å°„åˆ°url
	- åœ¨æµè§ˆå™¨è®¿é—®å“åº”urlçš„æ—¶å€™
	- æ‰§è¡Œç›¸åº”çš„ä»£ç 
	- è¿è¡Œæ—¶è®¿é—®æ•°æ®åº“å¹¶å¾—åˆ°ç»“æœ
	- å°†ç»“æœè¾“å‡ºåˆ°æµè§ˆå™¨çš„responseä¸­

### åˆä½œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658065746418)

- å ‚å€Œ(tomcat)å’Œå¨å¸ˆ(postgresql)ä¹‹é—´
- åˆä½œé¡ºåˆ©ï¼ï¼ï¼

### æ€»ç»“
- è¿™æ¬¡åœ¨tomcatæ­å»ºäº†servletç”¨æ¥è®¿é—®postgresæ•°æ®åº“
- åœ¨webappä¸‹é¢çš„WEB-INF/web.xmlä¸­
	- å»ºç«‹äº† url-pattern å’Œ servlet-name ä¹‹é—´çš„å…³ç³»
	- å»ºç«‹äº† servlet-name å’Œ servlet-class ä¹‹é—´çš„å…³ç³»
- åˆ¶ä½œäº† servlet çš„ class å¹¶ä¸”å†æµè§ˆå™¨ä¸­è®¿é—®
	- è¿™æ ·å°±å¯ä»¥åœ¨æµè§ˆå™¨æŸ¥çœ‹ select è¯­å¥çš„ç»“æœäº†
	- ä¸è¿‡æ¯æ¬¡ä¿®æ”¹ä»£ç éƒ½è¦é‡å¯ tomcat è¿™å¤ªéº»çƒ¦äº†
	- æˆ‘æƒ³è¦ä¸é‡å¯ tomcat è‡ªåŠ¨åŠ è½½ class
- å¯ä»¥ä¹ˆï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹

