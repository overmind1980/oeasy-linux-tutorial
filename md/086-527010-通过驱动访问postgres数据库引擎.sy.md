---
show: step
version: 1.0
enable_checker: true
---

# é€šè¿‡é©±åŠ¨è¿æ¥postgres

## å›é¡¾
- æˆ‘ä»¬è®¾ç½®äº†postgreså¼•æ“
- æ·»åŠ äº†
	- æ•°æ®åº“
	- æ•°æ®è¡¨
	- æ•°æ®
- ä½†æ˜¯è¿™ä¸€åˆ‡éƒ½æ˜¯åœ¨postgresçš„å®¢æˆ·ç«¯psqlä¸Šå®Œæˆçš„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658022536351)

- æˆ‘ä»¬å…ˆè¯•è¯•æ¢å¤postgresä¸­çš„æ•°æ®

### æ¢å¤æ•°æ®åº“

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658022993335)


- æ•°æ®åº“ç»“æ„å’Œæ•°æ®ç¡®å®æ˜¯å¯ä»¥ä¸€æŠŠæ¢å¤çš„
- é‚£æˆ‘å¯ä»¥ä½¿ç”¨javaæ¥è¯»å†™postgresæ•°æ®åº“ä¸­çš„æ•°æ®ä¹ˆï¼Ÿ

### æœç´¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631441137230)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631441149209)


### å¼€å§‹ç¼–ç¨‹

- æŠŠä»£ç å¤åˆ¶ä¸‹æ¥
- ç„¶åå›åˆ°classes
- ç²˜è´´è¿›å…¥ä¸€ä¸ªPostgresJdbc.java

```java
import java.sql.Connection;
import java.sql.DriverManager;

public class PostgresJdbc {
   public static void main(String args[]) {
      Connection c = null;
      try {
         Class.forName("org.postgresql.Driver");
         c = DriverManager
            .getConnection("jdbc:postgresql://localhost:5432/testdb",
            "postgres", "123");
      } catch (Exception e) {
         e.printStackTrace();
         System.err.println(e.getClass().getName()+": "+e.getMessage());
      }
      System.out.println("Opened database successfully");
   }
}
```

- æ³¨æ„å…¬æœ‰ç±»çš„ç±»åå’Œæ–‡ä»¶åä¸€è‡´
- å°è¯•ç¼–è¯‘

### ç¼–è¯‘è¿è¡Œ

- ç¼–è¯‘æ²¡æœ‰é‡åˆ°é—®é¢˜
- ä½†æ˜¯è¿è¡Œé‡åˆ°äº†é—®é¢˜

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211120-1637412762597)

- é¦–å…ˆçš„é—®é¢˜å°±æ˜¯æ‰¾ä¸åˆ°é©±åŠ¨
- æç¤ºéœ€è¦ä¸€ä¸ªpostgresql-jdbcé©±åŠ¨
- ä»€ä¹ˆæ˜¯é©±åŠ¨å‘¢ï¼Ÿ

### é©±åŠ¨

- driveré©¾é©¶å‘˜
- æœ€æ—©æ¥è‡ªäºé©¾é©¶é©¬è½¦

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220521-1653122800305)

### è’¸æ±½æœºè½¦

- åæ¥å·¥ä¸šé©å‘½åä¹ŸæŒ‡è’¸æ±½æœºè½¦

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220501-1651358573525)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220501-1651357981528)

- ä»ªè¡¨ç›˜çš„æ¥å†
	- ä»ªè¡¨ç›˜çš„ä½œç”¨æ˜¯ç›‘æ§å¼•æ“è¿è¡Œæƒ…å†µ
- driveråœ¨ç”µè„‘ç³»ç»Ÿä¸­ä¹ŸæŒ‡é©±åŠ¨
	- ç¡¬ä»¶çš„é©±åŠ¨ç¨‹åº
	- æ–‡ä»¶ç³»ç»Ÿé©±åŠ¨å™¨
	- ä¸»åŠ¨æ§åˆ¶å¼•æ“çš„äºº

### ä¸‹è½½é©±åŠ¨

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631441201792)

- ä¸‹è½½postgresql jdbc 4.2 driver

```
sudo wget https://jdbc.postgresql.org/download/postgresql-42.3.1.jar
```

- ä½†æ˜¯å„ä½åŒå­¦å¯èƒ½æ²¡æœ‰å¤–ç½‘
- å¯ä»¥è‡ªå·±å»ç½‘å€ä¸‹è½½ä¸‹è½½
	- å†ä¼ åˆ°~/Code
	- ç„¶åç§»åŠ¨åˆ°/tomcat/lib
	- ä¸€èˆ¬è¿™é‡Œæ”¾ç½®liberies ç±»åº“
- æˆ‘æŠŠä»–ä¼ åˆ°äº†githubå’Œgitee
	- git clone http://github.com/overmind1980/tomcat10.git

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658023187522)

### è®¾ç½®è·¯å¾„

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658023548402)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658023558728)

### å†æ¬¡å°è¯•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220425-1650890063904)

- å†æ¬¡å°è¯•è¿è¡Œ
- åŸæ¥å¯èƒ½æ˜¯postgresæ²¡å¼€

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658020472789)

### å†ä¸‰è¿è¡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658023733967)

- ç¼–è¯‘å¯ä»¥é€šè¿‡
	- ç°åœ¨çš„é—®é¢˜æ˜¯password authentication
- å¯†ç éªŒè¯å¤±è´¥
- å…ˆå»æºç¨‹åºçœ‹çœ‹

### æºç¨‹åº

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631444184189)

- ç”¨æˆ·åæ˜¯postgresåº”è¯¥æ²¡æœ‰é—®é¢˜
- ä½†æ˜¯å¯†ç åº”è¯¥æ˜¯ä»€ä¹ˆï¼Ÿ

### æœç´¢

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631444338028)

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631444427459)

- æ³¨æ„è¿™ä¸¤ä¸ªå¯†ç 
	- ä¸€ä¸ªæ˜¯æ•°æ®åº“ä¸­çš„çš„postgresè´¦å·çš„å¯†ç 
		- è¿™ä¸ªç”¨æ¥åœ¨é»˜è®¤ç«¯å£5432è¿æ¥æ•°æ®åº“
		- æ˜¯æ•°æ®åº“ä¸­postgresè¿™ä¸ªç”¨æˆ·å¯¹åº”çš„å¯†ç 
		- æ˜¯javaç¨‹åºé€šè¿‡é©±åŠ¨æ§åˆ¶æ•°æ®åº“çš„å¯†ç 
	- å¦ä¸€ä¸ªæ˜¯linuxç³»ç»Ÿä¸­çš„postgresç”¨æˆ·çš„å¯†ç 
		- è¿™ä¸ªç³»ç»Ÿä¸­çš„postgresç”¨sshæ¥ç™»å½•æ—¶ç”¨çš„å¯†ç 
		- æ˜¯ç³»ç»Ÿç”¨æˆ·çš„å¯†ç 
		- å¯ä»¥åœ¨ç³»ç»Ÿä¸­ç”¨æ¥ç™»å½•postgresè´¦å·
	- æˆ‘ä»¬åœ¨javaä¸­ç”¨çš„æ˜¯æ•°æ®åº“ä¸­postgresç”¨æˆ·çš„å¯†ç 
- è¿™ä¸ªå¦‚ä½•ä¿®æ”¹å‘¢ï¼Ÿ


### å¦‚ä½•ä¿®æ”¹
![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631444544416)

- è¿™æ˜¯ä¿®æ”¹ç³»ç»Ÿä¸­postgresè´¦å·å¯†ç çš„æ–¹æ³•
- æˆ‘ä»¬å»ä¿®æ”¹æ•°æ®åº“ä¸­postgresçš„å¯†ç 

### æŸ¥è¯¢å¸®åŠ©

- `:h ALTER ROLE`

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658366064210)

### ä¿®æ”¹æ•°æ®åº“ä¸­postgresçš„å¯†ç 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658366367876)

- æˆ‘ä»¬æŠŠå¯†ç è®¾ç½®ä¸ºoeasy@pg
- ä½†æ˜¯è¿™ä¸ªå¯†ç å¯ä»¥ä½œä¸ºç³»ç»Ÿpostgresç”¨æˆ·çš„ç™»å½•å¯†ç ä¹ˆï¼Ÿ
- æˆ‘ä»¬å»è¯•è¯•

### å°è¯•ç™»å½•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658367564965)

- è¿™ä¸ªè´¦å·æ˜¯ä¸èƒ½ç”¨æ¥ç™»å½•ç³»ç»Ÿçš„postgresè´¦å·çš„
- é‚£å¦‚æœæˆ‘ä»¬æƒ³è¦ç™»å½•ç³»ç»Ÿçš„postgresè´¦å·åº”è¯¥æ€ä¹ˆåŠï¼Ÿ

### ä¿®æ”¹ç³»ç»Ÿä¸­postgresçš„å¯†ç 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220721-1658367868379)

- çœ‹èµ·æ¥ç³»ç»Ÿçš„å¯†ç æ˜¯åœ¨ç³»ç»Ÿé‡Œé¢å¯ä»¥ç™»é™†çš„
	- åºŸè¯ï¼ğŸ˜„
- postgresæ•°æ®åº“ä¸­çš„postgresç”¨æˆ·æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿ

### ä¿®æ”¹ç¨‹åº

- ç„¶åå»ä¿®æ”¹PostgresJdbc.javaæºç¨‹åº

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211120-1637414533817)

### å†æ¬¡ç¼–è¯‘è¿è¡Œ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211120-1637414580434)

- è¿™æ¬¡å¯†ç è®¤è¯è¿‡å»äº†
- ä½†æ˜¯å¡åœ¨äº†æ•°æ®åº“çš„åç§°
- ç°åœ¨è¿™ä¸ªæ˜¯testdb
- æˆ‘ä»¬çš„databaseæ˜¯oeasy
- ä¿®æ”¹æºç 

### ä¿®æ”¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658017046429)

- ç¼–è¯‘è¿è¡Œ
### è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20211120-1637414717663)

- ç»ˆäºæˆåŠŸå•¦ï¼ï¼ï¼ï¼ï¼ï¼
- æˆ‘æƒ³ç”¨ä¸€äº›å¿«ä¹çš„è¯æ±‡
- ä½†æ˜¯æˆ‘å¿ä½äº†
- æˆ‘å“­äº†
- ç°åœ¨è¿˜ä¸æ˜¯åº†ç¥çš„æ—¶å€™
- æˆ‘æƒ³æŠŠurlsè¡¨é‡Œé¢çš„æ•°æ®æŸ¥è¯¢å‡ºæ¥

### æœç´¢

- æœç´¢èƒ½åŠ›æ˜¯å¾ˆé‡è¦
- çœŸæ­£æœ‰ä¸»è§çš„äºº
- éƒ½æ˜¯ä¼šæœç´¢çš„
- ç›¸ä¿¡ä¸–ç•Œä¹Ÿç›¸ä¿¡è‡ªå·±

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631445170233)

- æ„Ÿè§‰è‡ªå·±å……æ»¡äº†èƒ½é‡

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20210912-1631445186971)

- åº”è¯¥å°±æ˜¯è¿™æ ·å­å¯ä»¥æŸ¥è¯¢æ•°æ®åº“ 
- æŠŠ3è¡Œåˆ°46è¡Œæ‹¿åˆ°æˆ‘ä»¬çš„PostgresJdbc.javaä¸­

### ä¿®æ”¹

```java
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class PostgresJdbc {
	public static void main(String args[]) {
		Connection c = null;
		Statement stmt = null;
		try {
			Class.forName("org.postgresql.Driver");
			c = DriverManager.getConnection(
					"jdbc:postgresql://localhost:5432/oeasy", "postgres",
					"oeasy@pq");
			System.out.println("Pq Connection success!");
			stmt = c.createStatement();
			ResultSet rs = stmt.executeQuery("select * from urls");
			while(rs.next()){
				String topic = rs.getString("topic");
				String url = rs.getString("url");
				System.out.print(topic+":"+url+"\n");
			}
			rs.close();
			stmt.close();
			c.close();
		} catch (Exception e) {
			e.printStackTrace();
			System.err.println(e.getClass().getName() + ": " + e.getMessage());
		}
		System.out.println("Pq select query success!");
	}
}
```

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20220717-1658024316982)

- çœŸçš„å¯ä»¥é€šè¿‡jdbcé“¾æ¥åˆ°æ•°æ®åº“
- ç„¶åå¾—åˆ°æ•°æ®
- æˆ‘ä»¬å…ˆå»æ€»ç»“ä¸€ä¸‹


### æ€»ç»“ ğŸ¤¨
- è¿™æ¬¡æˆ‘ä»¬ç¼–è¾‘ Postgres.java æˆåŠŸè®¿é—®äº† pqæ•°æ®åº“
	- é¦–å…ˆè¦å¯¼å…¥ç±»åº“
	- ç„¶åè¦å¼€å¯æ•°æ®åº“
	- å¹¶äº†è§£æ•°æ®åº“çš„ç”¨æˆ·åå¯†ç 
	- è¦ç”¨æ­£ç¡®çš„è¿æ¥ã€åº“ã€è¡¨ã€å­—æ®µ
	- è¿˜è¦ä½¿ç”¨æ­£ç¡®çš„sqlè¯­å¥
- çœŸçš„åªè¦ç…§çŒ«ç”»è™æ”¹ä»£ç å°±å¯ä»¥è¿æ¥æ•°æ®åº“äº†
- è¿™ç§æ–¹å¼æ˜¯é€šè¿‡jdbcæ–¹å¼è¿›è¡Œçš„
- ä»€ä¹ˆæ˜¯jdbcå‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ï¼ğŸ‘‹

