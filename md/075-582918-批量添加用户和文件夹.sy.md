---
show: step
version: 1.0
enable_checker: true
---

# ä¿®æ”¹æ–‡ä»¶æƒé™(chmod)

## å›å¿†

- æˆ‘ä»¬ä¸Šæ¬¡äº†è§£äº†ç²˜æ»ä½sticky
-  é€šè¿‡chmod o+tå¯ä»¥è®¾ç½®
-  è®¾ç½®ä¹‹å
-  åªæœ‰rootå’Œè‡ªèº«æ–‡ä»¶æ‰€æœ‰è€…å¯ä»¥åˆ é™¤

|  mode   | è¯´æ˜  |
|  ----  | ----  |
| S_IRWXU  | ç”¨æˆ·(æ‰€æœ‰è€…)è¯»ã€å†™ã€æ‰§è¡Œ |
| S_IRUSR  | ç”¨æˆ·(æ‰€æœ‰è€…)è¯» |
| S_IRWUSR | ç”¨æˆ·(æ‰€æœ‰è€…)å†™ |
| S_IRXUSR  | ç”¨æˆ·(æ‰€æœ‰è€…)æ‰§è¡Œ |
| S_IRWXG  | ç”¨æˆ·ç»„è¯»ã€å†™ã€æ‰§è¡Œ |
| S_IRGRP  | ç”¨æˆ·ç»„è¯» |
| S_IWGRP  | ç”¨æˆ·ç»„å†™ |
| S_IXGRP  | ç”¨æˆ·ç»„æ‰§è¡Œ |
| S_IRWXO  | å…¶ä»–è¯»ã€å†™ã€æ‰§è¡Œ |
| S_IROTH  | å…¶ä»–è¯» |
| S_IROTH  | å…¶ä»–å†™ |
| S_IROTH  | å…¶ä»–æ‰§è¡Œ |
| S_ISUID  | æ‰§è¡Œæ—¶è®¾ç½®ç”¨æˆ·id |
| S_ISGID  | æ‰§è¡Œæ—¶è®¾ç½®ç”¨æˆ·ç»„id |
| STICKY  | åªæœ‰æ–‡ä»¶æ‰€æœ‰è€…å’Œrootå¯ä»¥åˆ é™¤ |

- äº†è§£äº†è¿™ä¹ˆå¤š
- æˆ‘å¯ä»¥
	- è¯»å–ä¸€ä¸ªcsvæ–‡ä»¶
	- æ–°å»ºè‹¥å¹²ç›®å½•ã€ç”¨æˆ·
	- å¹¶ä¸”è¿›è¡Œè®¾ç½®å—ï¼Ÿ

### è¯»å–csvæ–‡ä»¶

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665657564554)

- è¯»å–äº†csvæ–‡ä»¶ä¹‹å
- è¾“å‡ºå…·ä½“çš„å·ç 

### è¾“å‡ºå·ç 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665659481780)

- è¿è¡Œç»“æœ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665659497328)

- æˆ‘ä»¬çš„ç›®çš„æ˜¯åœ¨nginxçš„è·¯å¾„ä¸‹å»ºç«‹è·¯å¾„

### å»ºç«‹æ–‡ä»¶å¤¹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665660838490)

- å…ˆåˆ é™¤
- å†å»ºç«‹

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665664631824)

- ç„¶åéœ€è¦æ·»åŠ ç”¨æˆ·

### å…ˆæŸ¥å¸®åŠ©

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665664867271)

- æˆ‘ä»¬é¦–å…ˆå¯ä»¥è¯•ç€è®¾ç½®ä¸€ä¸‹

### adduser

- å¯ä»¥æ·»åŠ ç”¨æˆ·
- å¹¶è®¾ç½®å®¿ä¸»ç›®å½•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665666344593)

- å°è¯•è®¾ç½®shell

### shell

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665667556772)

- å¦‚æœè¦æ·»åŠ group
- åº”è¯¥å¦‚ä½•å‘¢ï¼Ÿ

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665666713831)

- é‚£å¦‚ä½•æ–°å»ºä¸€ä¸ªgroup
- å¹¶çŸ¥é“ä»–çš„gidå‘¢ï¼Ÿ

### æŸ¥è¯¢æ–‡æ¡£

- man addgroup

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665667094434)

- åº”è¯¥æ˜¯ç”¨--gidå‚æ•°

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665667278597)

- æ„å»ºå®Œæ•´æ·»åŠ ç”¨æˆ·è¯­å¥

### æ„å»ºè¯­å¥

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665667674486)

- æˆåŠŸä¹‹å
- åˆ é™¤ä¸å¿…è¦çš„ç»„å’Œç”¨æˆ·
- å°è¯•æ·»åŠ csvä¸­çš„ç”¨æˆ·å

### æ·»åŠ 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665668529320)

- ç›´æ¥æ·»åŠ æ˜¯å¤±è´¥çš„
- ç”¨æˆ·åä¸èƒ½æ•°å­—å¼€å¤´

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665668572924)

- å¼€å¤´æœ‰å­—æ¯å°±å¥½åŠå¤šäº†
- ä½†æ˜¯è¿˜éœ€è¦è¾“å…¥å¯†ç 
- æˆ‘æƒ³è‡ªåŠ¨å®Œæˆ

### é€šè¿‡ç®¡é“é€yes

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221013-1665668678054)

- è¯•éªŒæˆåŠŸï¼
- echo yes | sudo adduser num --home /usr/share/nginx/html/ num --shell /usr/bin/zsh

- è¿˜éœ€è¦è®¾ç½®å¯†ç æ‰èƒ½ç™»é™†

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221016-1665906419928)

### æœ€ç»ˆä»£ç 

- æœ€ç»ˆä»£ç 

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221016-1665906722059)

- å¦‚ä¸‹

```
#!/usr/bin/python3
import os
os.system("sudo addgroup og --gid 2000")
with open("list.csv") as f:
    lines = f.readlines()
for line in lines:
    num = line.replace("\n","")
    num = "o" + num
    os.system("sudo deluser " + num)
    os.system("sudo rm -rf /usr/share/nginx/html/" + num)
    os.system("sudo mkdir /usr/share/nginx/html/" + num)
    cmd = "echo yes "\
        + "| sudo adduser " + str(num)\
        + " --home /usr/share/nginx/html/" + str(num)\
        + " --shell /usr/bin/zsh"\
        + " --gid 2000"
    os.system(cmd)
    cmd = "echo \"" + num + ":oeasy\" | sudo chpasswd"
    os.system(cmd)
    print(cmd)
    cmd = "cp -r /root/.zshrc /var/www/html/" + num
    os.system(cmd)
    cmd = "cp -r /root/.oh-my-zsh /var/www/html/" + num
    os.system(cmd)
    cmd = "cp -r /root/.vimrc /var/www/html/" + num
    os.system(cmd)
    cmd = "cp -r /root/.cache /var/www/html/" + num
    os.system(cmd)
cmd = "chmod -R a+w /var/www/html/"
```

- å¯ä»¥ç™»é™†å—ï¼Ÿ

### ç™»å½•

![å›¾ç‰‡æè¿°](https://doc.shiyanlou.com/courses/uid1190679-20221016-1665906792893)

- å‰ææ˜¯
	- è·¯å¾„å­˜åœ¨
	- å¹¶ä¸”zshä¹Ÿå­˜åœ¨
- ç™»å½•æˆåŠŸ

### æ€»ç»“ ğŸ¤¨ 

- è¿™æ¬¡æ ¹æ®ä¸€ä¸ªcsvæ–‡ä»¶
	- æ‰¹é‡å»ºç«‹äº†ä¸€æ‰¹å­¦ç”Ÿç”¨æˆ·
	- è®©è¿™äº›ç”¨æˆ·å±äºåŒä¸€ä¸ªç»„
	- ç„¶åè®¾ç½®è¿™äº›ç”¨æˆ·çš„å®¿ä¸»æ–‡ä»¶å¤¹å’Œé»˜è®¤shell
	- æœ€ç»ˆå¯ä»¥è®©è¿™äº›ç”¨æˆ·è¿œç¨‹ç™»å½•
	- æ¯ä¸ªå­¦ç”Ÿå¯ä»¥åœ¨è‡ªå·±çš„æ–‡ä»¶å¤¹ä¸‹ç¼–è¾‘ç½‘é¡µ
	- è¿™å…¶å®å¹¶ä¸éš¾
- å½“ç„¶è¿™é‡Œé¢å…¶å®è¿˜å¯ä»¥æœ‰æ›´ç»†èŠ‚çš„æƒé™è®¾ç½®
	- å­¦ç”Ÿæ˜¯å¦å¯ä»¥æ‰§è¡Œæ–‡ä»¶å¤¹ä¸­çš„ç¨‹åº
	- å­¦ç”Ÿæ˜¯å¦å¯ä»¥çœ‹åŒç»„åŒå­¦çš„ç½‘é¡µ
	- æ˜¯å¦å¯ä»¥æ”¹åŒç»„åŒå­¦çš„ç½‘é¡µ
- å¤šäººåä½œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´å¥½ç”¨çš„æ–¹æ³•å‘¢ï¼ŸğŸ¤”
- ä¸‹æ¬¡å†è¯´ğŸ‘‹